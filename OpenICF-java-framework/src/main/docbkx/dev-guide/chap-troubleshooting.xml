<?xml version="1.0" encoding="UTF-8"?>
<!--
  ! CCPL HEADER START
  !
  ! This work is licensed under the Creative Commons
  ! Attribution-NonCommercial-NoDerivs 3.0 Unported License.
  ! To view a copy of this license, visit
  ! http://creativecommons.org/licenses/by-nc-nd/3.0/
  ! or send a letter to Creative Commons, 444 Castro Street,
  ! Suite 900, Mountain View, California, 94041, USA.
  !
  ! You can also obtain a copy of the license at
  ! legal-notices/CC-BY-NC-ND.txt.
  ! See the License for the specific language governing permissions
  ! and limitations under the License.
  !
  ! If applicable, add the following below this CCPL HEADER, with the fields
  ! enclosed by brackets "[]" replaced with your own identifying information:
  !      Portions Copyright [yyyy] [name of copyright owner]
  !
  ! CCPL HEADER END
  !
  !      Copyright 2012-2015 ForgeRock AS
  !
-->
<chapter xml:id='chap-troubleshooting'
         xmlns='http://docbook.org/ns/docbook' version='5.0' xml:lang='en'
         xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
         xsi:schemaLocation='http://docbook.org/ns/docbook http://docbook.org/xml/5.0/xsd/docbook.xsd'
         xmlns:xlink='http://www.w3.org/1999/xlink'
         xmlns:xinclude='http://www.w3.org/2001/XInclude'>
 <title>Troubleshooting Connectors</title>

 <para>
  Sometimes it is difficult to assess whether the root of a problem is at the
  OpenICF or connector level, or at the application level.
 </para>
 <para>
  If you are using OpenICF connectors with OpenIDM, you can adjust the log
  levels for specific parts of the system in the
  <filename>path/to/openidm/conf/logging.properties</filename> file.
 </para>
 <para>
  The OpenICF API sets the <literal>LoggingProxy</literal> at a very high level.
  You can consider the Logging Proxy as the <emphasis>border</emphasis> between
  the application (OpenIDM) and the OpenICF framework.
 </para>
 <para>
  To start a troubleshooting process, you should therefore enable the
  Logging Proxy and set it at a level high enough to provide the kind of
  information you need:
 </para>
<programlisting>org.identityconnectors.framework.impl.api.LoggingProxy.level=FINE</programlisting>

 <programlisting>org.identityconnectors.framework.impl.api.LoggingProxy.level=DEBUG</programlisting>
<programlisting>
#Enable the LoggingProxy
org.identityconnectors.framework.impl.api.LoggingProxy.level=FINE

#Select the operation you want to trace, to trace all add:
org.identityconnectors.framework.api.operations.level=FINE

#To trace only some:
org.identityconnectors.framework.api.operations.CreateApiOp.level=FINE
org.identityconnectors.framework.api.operations.UpdateApiOp.level=FINE
org.identityconnectors.framework.api.operations.DeleteApiOp.level=FINE
</programlisting>
 <para>
  The complete list of operations that you can trace is as follows:
 </para>
 <programlisting>
 AuthenticationApiOp
 CreateApiOp
 DeleteApiOp
 GetApiOp
 ResolveUsernameApiOp
 SchemaApiOp
 ScriptOnConnectorApiOp
 ScriptOnResourceApiOp
 SearchApiOp
 SyncApiOp
 TestApiOp
 UpdateApiOp
 ValidateApiOp
 </programlisting>

 <para>
  To enable logging in the remote Java Connector Server, edit the xml
  configuration file <filename>/lib/framework/logback.xml</filename> to
  uncomment the following line:
 </para>

<programlisting>
  &lt;logger name="org.identityconnectors.framework.impl.api.LoggingProxy" level="DEBUG" additivity="false">
      &lt;appender-ref ref="TRACE-FILE"/>
  &lt;/logger>
</programlisting>

 <para>
 To enable logging in the remote .NET Connector Server, edit the configuration
  file <filename>ConnectorServer.exe.config</filename>, setting the following
  value to <literal>true</literal>
 </para>
 <programlisting>
  &lt;add key="logging.proxy" value="false"/>
 </programlisting>

</chapter>
